# openpyxl



## Â∑•‰ΩúÁ∞øÊìç‰Ωú

#### 1. Âä†ËΩΩ‰∏Ä‰∏™Â∑≤ÊúâxlsxÊñá‰ª∂

```python
from openpyxl import load_workbook
file_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
file_name = os.path.join(file_path, 'demodata', 'demo_01.xlsx')
f = open(file_name, mode='rb+')
# f.close()
work_book = load_workbook(filename=f)
```



#### 2. Ëé∑ÂèñÊâÄÊúâsheetË°®Âêç

```python
names = work_book.sheetnames
print(names)
>>>['ËØ¶ÊÉÖ', 'Êï∞ÊçÆÊ±áÊÄª', 'Mysheet1', 'Mysheet']
```



#### 3.ÂàõÂª∫‰∏ÄÂº†Â∑•‰ΩúË°®

```python
work_book.create_sheet('Mysheet')
work_book.create_sheet('Mysheet1')
```



#### 4.Âà†Èô§‰∏ÄÂº†Â∑•‰ΩúË°®

```python
work_book.remove('Mysheet1')
```



#### 5. ÈÄâÊã©‰∏Ä‰∏™sheetÂØπË±°

```python
work_sheet = work_book['Mysheet']
```







## Ë°®ÂçïÊìç‰Ωú

**ÂâçÁΩÆÊìç‰Ωú**

```python
from openpyxl import load_workbook
file_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
file_name = os.path.join(file_path, 'demodata', 'demo_01.xlsx')
f = open(file_name, mode='rb+')
# f.close()
work_book = load_workbook(filename=f)
work_sheet = work_book['Mysheet']
```



#### 1.Ëé∑ÂèñsheetË°®ÂçïÁöÑÂêçÂ≠ó

```python
sheet_name = work_sheet.title
```



#### 2. ‰øÆÊîπsheetË°®ÂçïÁöÑÂêçÂ≠ó

```python
work_sheet.title = 'Mysheet-edit'
```



#### 3. ÁªôÂçïÂÖÉÊ†ºÂØπË±°ËµãÂÄº(2‰∏≠ÊñπÊ≥ï)

```python
sheet_cell = work_sheet['A1']  # Ëé∑ÂèñÂçïÂÖÉÊ†ºÂØπË±°
sheet_cell.value = 'hello world' #‰øÆÊîπÂÄº
print(sheet_cell.value)			#ËØªÂÄº

"""Á¨¨‰∫åÁßç"""
c = work_sheet.cell(row=1, column=1, value='world hello')	#Ëé∑ÂèñÂçïÂÖÉÊ†ºÂØπË±°Âπ∂Áªô‰ªñËµãÂÄº
c.value = 22												#‰øÆÊîπÂÄº
print(c.value)												#ËØªÂÄº
```



#### 4.Ëé∑ÂèñË°®ÂçïÊúÄÂ§ßË°å

```python
work_sheet.max_row
```



#### 5.Ëé∑ÂèñË°®ÂçïÊúÄÂ§ßÂàó

```python
work_sheet.max_column
```



#### 6. ÈÄöËøáÁîüÊàêÂô®Ëé∑ÂèñÊØè‰∏ÄË°å

> - ‚Äã	**rowsÊñπÊ≥ï‰ª•0 - max_rowÂíåA - max_column‰∏∫ËåÉÂõ¥ËøîÂõû‰∏Ä‰∏™Ë°åÁîüÊàêÂô®**
> - ‚Äã    **ÁîüÊàêÂô®‰ª•tupleÁöÑÂΩ¢ÂºèÔºåÊØèÊ¨°ËøîÂõû‰∏ÄË°åÔºåtuple‰∏≠ÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩÊòØ‰∏Ä‰∏™cellÂØπË±°**
>   - ÂèØ‰ª•ÈÄöËøácell.valueËøõË°åËµãÂÄºÂíåÂç¥ÂÄº

```python
rows_generator = work_sheet.rows
for each_row in rows_generator:
    print(each)
    
>>>
(<Cell 'Mysheet'.A1>, <Cell 'Mysheet'.B1>, <Cell 'Mysheet'.C1>)
(<Cell 'Mysheet'.A2>, <Cell 'Mysheet'.B2>, <Cell 'Mysheet'.C2>)
```



#### 7. ÈÄöËøáÁîüÊàêÂô®Ëé∑ÂèñÊØè‰∏ÄÂàó

- ‚Äã	**rowsÊñπÊ≥ï‰ª•0 - max_rowÂíåA - max_column‰∏∫ËåÉÂõ¥ËøîÂõû‰∏Ä‰∏™Ë°åÁîüÊàêÂô®**
- ‚Äã    **ÁîüÊàêÂô®‰ª•tupleÁöÑÂΩ¢ÂºèÔºåÊØèÊ¨°ËøîÂõû‰∏ÄË°åÔºåtuple‰∏≠ÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩÊòØ‰∏Ä‰∏™cellÂØπË±°**
  - ÂèØ‰ª•ÈÄöËøácell.valueËøõË°åËµãÂÄºÂíåÂç¥ÂÄº

```
rows_generator = work_sheet.rows
for each_row in rows_generator:
    print(each)
    
>>>
(<Cell 'Mysheet'.A1>, <Cell 'Mysheet'.B1>, <Cell 'Mysheet'.C1>)
(<Cell 'Mysheet'.A2>, <Cell 'Mysheet'.B2>, <Cell 'Mysheet'.C2>)
```



#### 8. ÈÄâÊã©‰∏Ä‰∏™ËåÉÂõ¥ÂÜÖÁöÑÊâÄÊúâcellÂØπË±°

> - ‚Äã	ËøîÂõû‰∏Ä‰∏™tuple
> - ‚Äã    ËøîÂõûÊ†ºÂºèÔºö((Á¨¨‰∏ÄË°åÊâÄÊúâcellÂØπË±°), (Á¨¨‰∫åË°åÊâÄÊúâcellÂØπË±°), (Á¨¨‰∏âË°åÊâÄÊúâcellÂØπË±°), ......)

```python
multiple_cells = work_sheet['A1:C3'] # A1 -- Âà∞C3Ëøô‰∏™Áü©ÂΩ¢ËåÉÂõ¥ÂÜÖÁöÑÊâÄÊúâcellÂØπË±°
for each in multiple_cells:
    print(each)
    
>>>
(<Cell 'Mysheet'.A1>, <Cell 'Mysheet'.B1>, <Cell 'Mysheet'.C1>)
(<Cell 'Mysheet'.A2>, <Cell 'Mysheet'.B2>, <Cell 'Mysheet'.C2>)
(<Cell 'Mysheet'.A3>, <Cell 'Mysheet'.B3>, <Cell 'Mysheet'.C3>)
```





#### 9. üî∫rows ËøòÊúâ max_row, max_column Âíå cellÂØπË±°‰πãÈó¥ÁöÑÂÖ≥Á≥ª

> - ‚Äã	rows ËøòÊúâ max_row, max_column ÈªòËÆ§ÂèñsheetÊúÄËøúÂùêÊ†á,ÂÅáËÆæ‰∏∫(row=20, column=20)
> - ‚Äã    ÂΩìÊàë‰ª¨‰ΩøÁî®‰∫Üws.cell(row=10, column=10)ÊàñËÄÖws['A1:T20']



#### 10.üî∫freeze_panes ÂÜªÁªìÁ™óÊ†º

**üî∫Âè™ÊúâËøôÁé©ÊÑèÈúÄË¶ÅÊåáÂÆösheetÂØπË±°ÔºåÂÖ∂‰ªñÁöÑÂÖ®ÈÉ®ÈÉΩÊòØÂçïÁã¨‰ΩøÁî®**

> - ‚Äã	ÊúâÁöÑ Excel Êñá‰ª∂Êï∞ÊçÆÈáèÂæàÂ§ßÔºå‚ÄúÂÜªÁªì‚Äù Ê†áÈ¢òÂ≠óÊÆµÔºà‰∏ÄËà¨ÊòØÈ°∂ÈÉ®Âá†Ë°åÊàñÂ∑¶ËæπÂá†ÂàóÔºâÊúâÂä©‰∫éÈòÖËØª‰∏éÁêÜËß£Ëøô‰∫õÊï∞ÊçÆ
> - ‚Äã    **Worksheet ÂØπË±°Êã•Êúâ freeze_panes Â±ûÊÄßÔºåÊàë‰ª¨ÂèØ‰ª•‰∏∫ÂÖ∂ËÆæÁΩÆ‰∏∫‰∏Ä‰∏™ÂçïÂÖÉÊ†ºÁöÑ Cell ÂØπË±°Êàñ‰ª£Ë°®ÂÖ∂ÂùêÊ†áÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ`Ê≥®ÊÑè`ÔºöÔºåËøô‰∏™ÂçïÂÖÉÊ†º‰πã‰∏äÁöÑÊâÄÊúâË°åÂíåÂ∑¶ËæπÁöÑÊâÄÊúâÂàóÈÉΩ‰ºöË¢´ÂÜªÁªìÔºå‰ΩÜ‰∏ç‰ºöÂΩ±ÂìçÂÖ∂ÂçïÂÖÉÊ†ºÊâÄÂú®ÁöÑË°åÂíåÂàó„ÄÇÊâÄ‰ª•Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ A1ÔºåÊòØÊ≤°ÊúâÊïàÊûúÁöÑ„ÄÇ**

**‰æãÂ≠ê**

```python
wb = openpyxl.load_workbook('ÂÖ®ÂõΩÈ´òÊ†°ÂêçÂçï.xlsx')
sheet = wb.active
sheet.freeze_panes = 'A4'
wb.save('freeze.xlsx')
```



#### 11. WorksheetÂ±ûÊÄßÊñπÊ≥ïÊ±áÊÄª

```python
WorksheetÊèê‰æõÁöÑÈÉ®ÂàÜÂ∏∏Áî®Â±ûÊÄßÂ¶Ç‰∏ãÔºö

titleÔºöË°®Ê†ºÁöÑÊ†áÈ¢ò
dimensionsÔºöË°®Ê†ºÁöÑÂ§ßÂ∞èÔºåËøôÈáåÁöÑÂ§ßÂ∞èÊòØÊåáÂê´ÊúâÊï∞ÊçÆÁöÑË°®Ê†ºÁöÑÂ§ßÂ∞èÔºåÂç≥ÔºöÂ∑¶‰∏äËßíÁöÑÂùêÊ†á:Âè≥‰∏ãËßíÁöÑÂùêÊ†á
max_rowÔºöË°®Ê†ºÁöÑÊúÄÂ§ßË°å
min_rowÔºöË°®Ê†ºÁöÑÊúÄÂ∞èË°å
max_columnÔºöË°®Ê†ºÁöÑÊúÄÂ§ßÂàó
min_columnÔºöË°®Ê†ºÁöÑÊúÄÂ∞èÂàó
rowsÔºöÊåâË°åËé∑ÂèñÂçïÂÖÉÊ†º(CellÂØπË±°) - ÁîüÊàêÂô® üî∫Ë∞ÉÁî®ÁöÑÂ∞±ÊòØiter_rows() ÊñπÊ≥ïÔºåÂèÇÊï∞ÂÖ®ÈÉ®ÈªòËÆ§
columnsÔºöÊåâÂàóËé∑ÂèñÂçïÂÖÉÊ†º(CellÂØπË±°) - ÁîüÊàêÂô®  üî∫Ë∞ÉÁî®ÁöÑÂ∞±ÊòØiter_cols() ÊñπÊ≥ïÔºåÂèÇÊï∞ÂÖ®ÈÉ®ÈªòËÆ§
freeze_panesÔºöÂÜªÁªìÁ™óÊ†º
valuesÔºöÊåâË°åËé∑ÂèñË°®Ê†ºÁöÑÂÜÖÂÆπ(Êï∞ÊçÆ)  - ÁîüÊàêÂô® üî∫Ë∞ÉÁî®ÁöÑÂ∞±ÊòØiter_rows(value_only=True)
ws['A1:C3'] ÊåâË°åËåÉÂõ¥Ëé∑ÂèñcellÂØπË±°	ËøîÂõû‰∏Ä‰∏™ÂÖÉÁªÑÔºå Âè™ÊúâËøô‰∏Ä‰∏™‰∏çÊòØËøîÂõûÁîüÊàêÂô®ÔºåÂÖ∂‰ªñÁöÑÂü∫Êú¨ÈÉΩÊòØÊîæÂõûÁîüÊàêÂô®
```



```python
WorksheetÊèê‰æõÁöÑÈÉ®ÂàÜÂ∏∏Áî®ÊñπÊ≥ïÂ¶Ç‰∏ãÔºö

iter_rowsÔºöÊåâË°åËé∑ÂèñÊâÄÊúâÂçïÂÖÉÊ†ºÔºåÂÜÖÁΩÆÂ±ûÊÄßÊúâ(min_row,max_row,min_col,max_colÔºå values_only=False)
iter_colsÔºöÊåâÂàóËé∑ÂèñÊâÄÊúâÁöÑÂçïÂÖÉÊ†º (min_col=None, max_col=None, min_row=None, max_row=None, values_only=False):
append(iterable)ÔºöÂú®Ë°®Ê†ºÊú´Â∞æÊ∑ªÂä†Êï∞ÊçÆ		üî∫ Áî®‰∫éÂêàÂπ∂Â§ö‰∏™Ë°®Ê†º
merged_cellsÔºöÂêàÂπ∂Â§ö‰∏™ÂçïÂÖÉÊ†º
unmerged_cellsÔºöÁßªÈô§ÂêàÂπ∂ÁöÑÂçïÂÖÉÊ†º
```





## ÂÖ∂‰ªñÊñπÊ≥ï

#### from openpyxl.utils import *

```python
from .cell import (
    absolute_coordinate,	#Áõ¥Êé•Ë∞ÉÁî®Ôºå‰ΩÜÊòØÊÑüËßâÊó†Áî®
    cols_from_range,
    column_index_from_string,
    coordinate_to_tuple,    #Êó†Áî®
    get_column_letter,
    get_column_interval,
    quote_sheetname,	# Â∞ÜÂçïÂºïÂè∑ÊõøÊç¢ÊàêÂèåÂçïÂºïÂè∑ÔºåÊÑüËßâÊ≤°‰ªÄ‰πàÊÑè‰πâ
    range_boundaries,
    range_to_tuple,
    rows_from_range,
)

from .formulas import FORMULAE
```



#### 1.üî∫ get_column_letter

> - ‚Äã	**Ê†πÊçÆÊï¥ÂûãÊï∞Â≠óËé∑ÂèñÂØπ‰∫éÁöÑÂ≠óÊØç**
> - ‚Äã    **Áõ¥Êé•‰ΩøÁî®**
> - ‚Äã    **ÂèÇÊï∞ -- int**

```python
from openpyxl.utils import get_column_letter
letter = get_column_letter(100)
print(letter)

>>>CV
```



#### 2. get_column_interval - (‰ª•string_columnÁöÑÊñπÂºèÁΩóÂàóËåÉÂõ¥Êï¥‰∏™ËåÉÂõ¥,ËøîÂõû‰∏Ä‰∏™ÂàóË°®)

```python
def get_column_interval(start, end):
    pass
```

> - ‚Äã	**startÂíåendÂèØ‰ª•ÊòØint‰πüÂèØ‰ª•ÊòØstring_columnÁ±ªÂûã**
> - ‚Äã    **ÂèÇÊï∞ÔºöÔºà'A'Ôºå 'J'ÔºâÊàñËÄÖ(1, 10)**
> - ‚Äã    **ËøîÂõûÊ†ºÂºèÔºö['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J']**
> - ‚Äã    **ÂàóË°®‰∏≠ÁΩóÂàóÂá∫‰ªéstart Âà∞endÁöÑÊâÄÊúâÊï∞ÊçÆ(string_columnÁ±ªÂûã)**

```
from openpyxl.utils import get_column_interval
#string_list = get_colum_interval('A', 'J') ËøôÁßç‰πüÂèØ‰ª•
string_list = get_column_interval(1, 10)
print(string_list)

>>>['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J']
```



#### 3. üî∫column_index_from_string

> - ‚Äã	**Ê†πÊçÆstring_columnËé∑ÂèñÂØπ‰∫éÁöÑÁ¥¢Âºï**
> - ‚Äã    **Áõ¥Êé•‰ΩøÁî®**
> - ‚Äã    **ÂèÇÊï∞ -- Â≠óÁ¨¶26‰∏™Â§ßÂÜôÂ≠óÊØçÊàñÂÖ∂ÁªÑÂêà(string_column)**

```python
from openpyxl.utils import get_column_letter
index = column_index_from_string('ALL')
print(index)

>>>1000
```



#### 4. range_boundaries - (Â∞Üstring_columnÂΩ¢ÂºèÁöÑËåÉÂõ¥ÔºåËΩ¨Êç¢ÊàêÊï∞ÂÄºÂûãÁöÑËÆøÈóÆÔºåËøîÂõû‰∏Ä‰∏™tuple)

> - ‚Äã	boundaries -- ËæπÁïå
> - ‚Äã    ÂèÇÊï∞Ôºöstring_range
> - ‚Äã    ËøîÂõû‰∏Ä‰∏™ÂÖÉÁªÑ
> - ‚Äã    ËøîÂõûÊ†ºÂºèÔºö(1, 1, 3, 6)

```python
from openpyxl.utils import range_boundaries
int_tuple_range = range_boundaries('A1:C6')
print(int_tuple_range)

>>>(1, 1, 3, 6)
```





#### 5. range_to_tuple - Âíårange_boundaries ‰∏ÄÊ†∑Âè™ÊòØ‰º†ÂèÇÂíåËøîÂõûÊúâ‰∏ÄÁÇπÁï•ÂæÆ‰∏çÂêå

> - ‚Äã	**ÂèÇÊï∞Ôºö!string_range, Â§ö‰∏™ÊÑüÂèπÂè∑**
> - ‚Äã    **ËøîÂõûÂÖÉÁªÑ**
> - ‚Äã    **ËøîÂõûÊ†ºÂºè('', (1, 1, 3, 6))**

```python
from openpyxl.utils import range_to_tuple
int_tuple_range = range_to_tuple('!A1:C6')
print(int_tuple_range)


>>>
('', (1, 1, 3, 6))
```



#### 6.üî∫rows_from_range

> - ‚Äã	ÂèÇÊï∞ - string_range
> - ‚Äã    ËøîÂõû‰∏Ä‰∏™ÁîüÊàêÂô®
> - ‚Äã    ÁîüÊàêÂô®‰ª•tupleÁöÑÂΩ¢Âºè‰∏ÄÊ¨°ËøîÂõû`‰∏ÄË°å`

```python
from openpyxl.utils import rows_from_range
row_generator = rows_from_range('A1:C6')
for each in row_generator:
    print(each)
    
>>>
('A1', 'B1', 'C1')
('A2', 'B2', 'C2')
('A3', 'B3', 'C3')
('A4', 'B4', 'C4')
('A5', 'B5', 'C5')
('A6', 'B6', 'C6')
```







#### 7.üî∫cols_from_range

> - ‚Äã	ÂèÇÊï∞string_range
> - ‚Äã    ËøîÂõû‰∏Ä‰∏™ÁîüÊàêÂô®
> - ‚Äã    ÁîüÊàêÂô®ÊØèÊ¨°‰ª•tupleÁöÑÂΩ¢Âºè‰∏ÄÊ¨°ËøîÂõû`‰∏ÄÂàó`

```python
from openpyxl.utils import cols_from_range
column_generator = cols_from_range('A1:C6')
for each in column_generator:
    print(each)
    
>>>
('A1', 'A2', 'A3', 'A4', 'A5', 'A6')
('B1', 'B2', 'B3', 'B4', 'B5', 'B6')
('C1', 'C2', 'C3', 'C4', 'C5', 'C6')
```









## ËØªÂèñÊµãËØïÁî®‰æã

```python
from openpyxl import load_workbook
from constant.constant import CONFIG_PATH
import os.path

class ExcelReader(object):
    """
        Read the contents of the excel file, Return list.
        example:
        The contents of the excel fileÔºö
        | A  | B  | C  |
        | A1 | B1 | C1 |
        | A2 | B2 | C2 |
        print(ExcelReader(excel, title_line=True).data)ÔºåoutputÔºö
        [{A: A1, B: B1, C:C1}, {A:A2, B:B2, C:C2}]
        print(ExcelReader(excel, title_line=False).data)ÔºåoutputÔºö
        [[A,B,C], [A1,B1,C1], [A2,B2,C2]]
        You can specify sheet through index or name: 
        example:
        ExcelReader(excel, sheet=2)
        ExcelReader(excel, sheet='testdata')
    """

    def __init__(self, excel, sheet=0, title_line=True):
        if os.path.exists(excel):
           self.excel = excel
        else:
            raise FileNotFoundError('Excel file does not exist ÔºÅ')
        self.sheet = sheet
        self.title_line = title_line
        self._data = list()

    @property
    def data(self):
        if not self._data:
            workbook = load_workbook(self.excel)
            if type(self.sheet) not in [int, str]:
                raise TypeError('Please pass in <type int> or <type str>, not {0}'.format(type(self.sheet)))
            elif type(self.sheet) == int:
                sheetnames = workbook.sheetnames
                ws = workbook[sheetnames[self.sheet]]
            else:
                ws = workbook[self.sheet]

            if self.title_line:
                for row in ws.iter_rows(min_row=1, max_row=1, ):
                    title = [cell.value for cell in row]# È¶ñË°å‰∏∫title

                for i in range(1, ws.max_row):
                    every_row_cell_list = list(ws.rows)[i]
                    every_row_value = []
                    for cell in every_row_cell_list:
                        every_row_value.append(cell.value)
                    self._data.append(dict(zip(title, every_row_value)))
            else:
                for row in ws.rows:
                    self._data.append([cell.value for cell in row])
        return self._data

if __name__ == '__main__':
    file_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
	file_name = os.path.join(file_path, 'demodata', 'demo_03.xlsx')
    test_data = file_name
    reader = ExcelReader(test_data,sheet= 0,title_line=False)
    print(reader.data)
```





## ÁîüÊàêÂ§ßÈáèÊµãËØïÊï∞ÊçÆ100W

> - ‚Äã	20WÊï∞ÊçÆÂ∑Æ‰∏çÂ§ö80Áßí
> - ‚Äã    ËøòÈúÄÊîπËøõ‰∏Ä‰∏ãÔºåÊääÂ§öËøõÁ®ãÂä†ËøõÂéªÔºå‰∫âÂèñ20WÊï∞ÊçÆ 10Áßí

```python
#!/usr/bin/python3.6
# -*- coding: utf-8 -*-
# @Time    : 2021/3/25 23:53
# @Author  : Ë∂ÖÁ∫ßÊó†ÊïåÂº†ÈìÅÊü±
# @File    : pratice_openpyxl_write_100W.py


import os.path
import time
import random
from faker import Faker
from openpyxl import Workbook
from openpyxl.utils import *
from multiprocessing import Process, Queue, Lock
from concurrent.futures import ThreadPoolExecutor

"""
ÁªèËøáÂàÜÊûêÔºö
    1.ËøôÊòØ‰∏Ä‰∏™ÊêûCPUÁöÑÂú∫ÊôØÔºå‰∏çÊòØ‰∏Ä‰∏™È´òI/OÊ®°Âûã
    2.100WÁöÑÊï∞ÊçÆÈáè,ÂÜôÂÖ•ÁöÑÊó∂ÂÄôÈùûÂ∏∏Âùó
    3.Êó∂Èó¥Áâá‰∏ªË¶ÅÈõÜ‰∏≠Âú®CPUÂà∂ÈÄ†Êï∞ÊçÆ‰∏äÈù¢
    4.Â§öËøõÁ®ãÂàáÊç¢ÂºÄÊîØËæÉÂ§ß,Á∫øÁ®ãÊ±†ÂÆåÂÖ®Êª°Ë∂≥ÈúÄÊ±Ç,ÊúÄÂêéËøòÊòØÈÄâÊã©‰∫ÜÁ∫øÁ®ãÊ±†(ÂºÄÊîØÊõ¥Â∞è)
    5.wb.append,ÂÆåÂÖ®ÈÅøÂºÄ‰∫ÜÊï∞ÊçÆÂÆâÂÖ®ÁöÑÈóÆÈ¢ò,‰∏çÈúÄË¶ÅÂä†Á∫øÁ®ãÈîÅ
    6.ÈòüÂàóÂÆπÈáèÂ§™Â∞è‰∫Ü,Áé∞Âú®ÊâçÂèëÁé∞ÈòüÂàóÊúÄÂ§ßÂÆπÈáèÊâç10000,ÂÆåÂÖ®‰∏çÊª°Ë∂≥100WÁ∫ßÂà´ÁöÑÊï∞ÊçÆÂÜôÂÖ•
('ÂßìÂêç', 'ÁîµËØù', 'ÈÇÆÁÆ±', 'Ë∫´‰ªΩËØÅ', 'Áé∞Â±ÖÂú∞')
| ÂßìÂêç  | ÁîµËØù  | ÈÇÆÁÆ±  | Ë∫´‰ªΩËØÅ  | Áé∞Â±ÖÂú∞  |
|   A  |  B   |  C    |   D    |  E     |
"""
file_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
file_name = os.path.join(file_path, 'demodata', 'demo_04.xlsx')

wb = Workbook()
excel_head = ('ÂßìÂêç', 'ÁîµËØù', 'ÈÇÆÁÆ±', 'Ë∫´‰ªΩËØÅ', 'Áé∞Â±ÖÂú∞')
sheet_name = 'Mysheet'
sheet0 = wb.create_sheet(title=sheet_name, index=0)
ws = wb[sheet_name]
ws.append(excel_head)


# ÁîüÊàê(A, B, C, D, E, F)Á±ªÂûãÊï∞ÊçÆ
def produce_data(num=100):
    """
    :param num: ‰∏ÄÊ¨°ÁîüÊàêÂ§öÂ∞ë‰∏™Êï∞ÊçÆ
    :return: [(A, B, C),(D, E, F)]
    """
    f = Faker('zh-CN')
    fake_data_list = []
    for i in range(num):
        fake_name = f.name()
        fake_phone = maker_phone()
        fake_email = f.ascii_email()
        fake_id = f.ssn()
        fake_address = f.address()
        fake_data = (fake_name, fake_phone, fake_email, fake_id, fake_address)
        fake_data_list.append(fake_data)
    return fake_data_list


def maker_phone():
    num_113 = ["113" for i in range(3)]
    num_112 = ["189" for j in range(3)]
    num_111 = ["172" for k in range(4)]
    phone_num_head = num_113 + num_112 + num_111
    phone_head = random.sample(phone_num_head, 1)
    telephone = phone_head[0]
    phone_tail = []
    for i in range(8):
        slice = random.randint(0, 9)
        phone_tail.append(str(slice))

    res = telephone + "".join(phone_tail)
    return res


def write_to_excel(data_list):
    for data_tuple in data_list:
        ws.append(data_tuple)


if __name__ == '__main__':
    start_time = time.time()
    t_pool = ThreadPoolExecutor(max_workers=20)
    t_result = []
    for i in range(2000):
        t = t_pool.submit(produce_data, )
        t_result.append(t)
    for q in t_result:
        # print(t_result)
        # print(q.result())
        write_to_excel(data_list=q.result())

    total_time = time.time() - start_time
    wb.save(r'D:\Ëá™Âä®ÂåñËÑöÊú¨-newpull3\thing\demodata\demo_{num}.xlsx'.format(num=1000))
    print(ws.max_row)
    print(total_time)

```





## ÁîüÊàêÂ§ßÈáèÊµãËØïÊï∞ÊçÆ100W

> - ‚Äã	20WÊï∞ÊçÆ 40Áßí
> - ‚Äã    Â∞ùËØï400WÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºå ÁîµËÑëÂÜÖÂ≠òÁªôÂπ≤Êª°‰∫ÜÔºå ÊàëÊó•
> - ‚Äã     ÊÑüËßâË¶ÅÂÄüÂä©Êï∞ÊçÆÂ∫ìÊîØÊåÅÊâçË°å‰∫Ü



```python
#!/usr/bin/python3.6
# -*- coding: utf-8 -*-
# @Time    : 2021/3/25 23:53
# @Author  : Ë∂ÖÁ∫ßÊó†ÊïåÂº†ÈìÅÊü±
# @File    : pratice_openpyxl_write_100W.py


import os.path
import time
import random
from faker import Faker
from openpyxl import Workbook
from openpyxl.utils import *
from multiprocessing import Process, Queue, Lock, Pool
from concurrent.futures import ThreadPoolExecutor

"""
ÁªèËøáÂàÜÊûêÔºö
    1.ËøôÊòØ‰∏Ä‰∏™ÊêûCPUÁöÑÂú∫ÊôØÔºå‰∏çÊòØ‰∏Ä‰∏™È´òI/OÊ®°Âûã
    2.100WÁöÑÊï∞ÊçÆÈáè,ÂÜôÂÖ•ÁöÑÊó∂ÂÄôÈùûÂ∏∏Âùó
    3.Êó∂Èó¥Áâá‰∏ªË¶ÅÈõÜ‰∏≠Âú®CPUÂà∂ÈÄ†Êï∞ÊçÆ‰∏äÈù¢
    4.Â§öËøõÁ®ãÂàáÊç¢ÂºÄÊîØËæÉÂ§ß,Á∫øÁ®ãÊ±†ÂÆåÂÖ®Êª°Ë∂≥ÈúÄÊ±Ç,ÊúÄÂêéËøòÊòØÈÄâÊã©‰∫ÜÁ∫øÁ®ãÊ±†(ÂºÄÊîØÊõ¥Â∞è)
    5.wb.append,ÂÆåÂÖ®ÈÅøÂºÄ‰∫ÜÊï∞ÊçÆÂÆâÂÖ®ÁöÑÈóÆÈ¢ò,‰∏çÈúÄË¶ÅÂä†Á∫øÁ®ãÈîÅ
    6.ÈòüÂàóÂÆπÈáèÂ§™Â∞è‰∫Ü,Áé∞Âú®ÊâçÂèëÁé∞ÈòüÂàóÊúÄÂ§ßÂÆπÈáèÊâç10000,ÂÆåÂÖ®‰∏çÊª°Ë∂≥100WÁ∫ßÂà´ÁöÑÊï∞ÊçÆÂÜôÂÖ•
('ÂßìÂêç', 'ÁîµËØù', 'ÈÇÆÁÆ±', 'Ë∫´‰ªΩËØÅ', 'Áé∞Â±ÖÂú∞')
| ÂßìÂêç  | ÁîµËØù  | ÈÇÆÁÆ±  | Ë∫´‰ªΩËØÅ  | Áé∞Â±ÖÂú∞  |
|   A  |  B   |  C    |   D    |  E     |
"""
file_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
file_name = os.path.join(file_path, 'demodata', 'demo_04.xlsx')




# ÁîüÊàê(A, B, C, D, E, F)Á±ªÂûãÊï∞ÊçÆ
def produce_data(num=100):
    """
    :param num: ‰∏ÄÊ¨°ÁîüÊàêÂ§öÂ∞ë‰∏™Êï∞ÊçÆ
    :return: [(A, B, C),(D, E, F)]
    """
    f = Faker('zh-CN')
    fake_data_list = []
    for i in range(num):
        fake_name = f.name()
        fake_phone = maker_phone()
        fake_email = f.ascii_email()
        fake_id = f.ssn()
        fake_address = f.address()
        fake_data = (fake_name, fake_phone, fake_email, fake_id, fake_address)
        fake_data_list.append(fake_data)
    return fake_data_list


def maker_phone():
    num_113 = ["113" for i in range(3)]
    num_112 = ["189" for j in range(3)]
    num_111 = ["172" for k in range(4)]
    phone_num_head = num_113 + num_112 + num_111
    phone_head = random.sample(phone_num_head, 1)
    telephone = phone_head[0]
    phone_tail = []
    for i in range(8):
        slice = random.randint(0, 9)
        phone_tail.append(str(slice))

    res = telephone + "".join(phone_tail)
    return res


def write_to_excel(data_list, lock):
    lock.acquire()
    for data_tuple in data_list:
        ws.append(data_tuple)
    lock.release()

def thread_worker():
    """
    :return:[[(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)]]
    """
    t_pool = ThreadPoolExecutor(max_workers=20)
    t_result = []
    lock = Lock()
    for i in range(200):
        t = t_pool.submit(produce_data, )
        t_result.append(t)
    # for q in t_result:
    #     write_to_excel(data_list=q.result())
    data = [each.result() for each in t_result]
    return data


if __name__ == '__main__':
    start_time = time.time()
    wb = Workbook()
    excel_head = ('ÂßìÂêç', 'ÁîµËØù', 'ÈÇÆÁÆ±', 'Ë∫´‰ªΩËØÅ', 'Áé∞Â±ÖÂú∞')
    sheet_name = 'Mysheet'
    sheet0 = wb.create_sheet(title=sheet_name, index=0)
    ws = wb[sheet_name]
    ws.append(excel_head)
    p = Pool(5)
    p_result = []
    # ÊåáÂÆö‰ªªÂä°Êï∞
    for i in range(10):
        res = p.apply_async(thread_worker, )
        """
        [[(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)]], 
        [[(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)]]
        
        """
        p_result.append(res)
    for t_result_list in p_result:
        for t_result in t_result_list.get():
            for i in t_result:
                ws.append(i)
    wb.save(r'D:\Ëá™Âä®ÂåñËÑöÊú¨-newpull3\thing\demodata\demo_{num}.xlsx'.format(num=1000))
    total_time = time.time() - start_time
    print(ws.max_row)
    print(total_time)

"""
ÊúÄÂêéÁªìÊûú: 20WÊï∞ÊçÆÔºåÂè™Ë¶Å40Áßí

"""
```



#### 100WÊï∞ÊçÆ 177Áßí

```python
import os.path
import time
import random
from faker import Faker
from openpyxl import Workbook
from openpyxl.utils import *
from multiprocessing import Process, Queue, Lock, Pool
from concurrent.futures import ThreadPoolExecutor

"""
ÁªèËøáÂàÜÊûêÔºö
    1.ËøôÊòØ‰∏Ä‰∏™ÊêûCPUÁöÑÂú∫ÊôØÔºå‰∏çÊòØ‰∏Ä‰∏™È´òI/OÊ®°Âûã
    2.100WÁöÑÊï∞ÊçÆÈáè,ÂÜôÂÖ•ÁöÑÊó∂ÂÄôÈùûÂ∏∏Âùó
    3.Êó∂Èó¥Áâá‰∏ªË¶ÅÈõÜ‰∏≠Âú®CPUÂà∂ÈÄ†Êï∞ÊçÆ‰∏äÈù¢
    4.Â§öËøõÁ®ãÂàáÊç¢ÂºÄÊîØËæÉÂ§ß,Á∫øÁ®ãÊ±†ÂÆåÂÖ®Êª°Ë∂≥ÈúÄÊ±Ç,ÊúÄÂêéËøòÊòØÈÄâÊã©‰∫ÜÁ∫øÁ®ãÊ±†(ÂºÄÊîØÊõ¥Â∞è)
    5.wb.append,ÂÆåÂÖ®ÈÅøÂºÄ‰∫ÜÊï∞ÊçÆÂÆâÂÖ®ÁöÑÈóÆÈ¢ò,‰∏çÈúÄË¶ÅÂä†Á∫øÁ®ãÈîÅ
    6.ÈòüÂàóÂÆπÈáèÂ§™Â∞è‰∫Ü,Áé∞Âú®ÊâçÂèëÁé∞ÈòüÂàóÊúÄÂ§ßÂÆπÈáèÊâç10000,ÂÆåÂÖ®‰∏çÊª°Ë∂≥100WÁ∫ßÂà´ÁöÑÊï∞ÊçÆÂÜôÂÖ•
('ÂßìÂêç', 'ÁîµËØù', 'ÈÇÆÁÆ±', 'Ë∫´‰ªΩËØÅ', 'Áé∞Â±ÖÂú∞')
| ÂßìÂêç  | ÁîµËØù  | ÈÇÆÁÆ±  | Ë∫´‰ªΩËØÅ  | Áé∞Â±ÖÂú∞  |
|   A  |  B   |  C    |   D    |  E     |
"""
file_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
file_name = os.path.join(file_path, 'demodata', 'demo_04.xlsx')


# ÁîüÊàê(A, B, C, D, E, F)Á±ªÂûãÊï∞ÊçÆ
def produce_data(num=100):
    """
    :param num: ‰∏ÄÊ¨°ÁîüÊàêÂ§öÂ∞ë‰∏™Êï∞ÊçÆ
    :return: [(A, B, C),(D, E, F)]
    """
    f = Faker('zh-CN')
    fake_data_list = []
    for i in range(num):
        fake_name = f.name()
        fake_phone = maker_phone()
        fake_email = f.ascii_email()
        fake_id = f.ssn()
        fake_address = f.address()
        fake_data = (fake_name, fake_phone, fake_email, fake_id, fake_address)
        fake_data_list.append(fake_data)
    return fake_data_list


def maker_phone():
    num_113 = ["113" for i in range(3)]
    num_112 = ["189" for j in range(3)]
    num_111 = ["172" for k in range(4)]
    phone_num_head = num_113 + num_112 + num_111
    phone_head = random.sample(phone_num_head, 1)
    telephone = phone_head[0]
    phone_tail = []
    for i in range(8):
        slice = random.randint(0, 9)
        phone_tail.append(str(slice))

    res = telephone + "".join(phone_tail)
    return res


def write_to_excel(data_list, lock):
    lock.acquire()
    for data_tuple in data_list:
        ws.append(data_tuple)
    lock.release()


def thread_worker():
    """
    :return:[[(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)]]
    """
    t_pool = ThreadPoolExecutor(max_workers=20)
    t_result = []
    lock = Lock()
    for i in range(200):
        t = t_pool.submit(produce_data, )
        t_result.append(t)
    # for q in t_result:
    #     write_to_excel(data_list=q.result())
    data = [each.result() for each in t_result]
    return data


if __name__ == '__main__':
    start_time = time.time()
    wb = Workbook()
    excel_head = ('ÂßìÂêç', 'ÁîµËØù', 'ÈÇÆÁÆ±', 'Ë∫´‰ªΩËØÅ', 'Áé∞Â±ÖÂú∞')
    sheet_name = 'Mysheet'
    sheet0 = wb.create_sheet(title=sheet_name, index=0)
    ws = wb[sheet_name]
    ws.append(excel_head)
    p = Pool(8)
    p_result = []
    # ÊåáÂÆö‰ªªÂä°Êï∞
    for i in range(50):
        res = p.apply_async(thread_worker)
        """
        [[(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)]], 
        [[(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)], [(A, B, C),(D, E, F)]]

        """
        p_result.append(res)
    print(len(p_result))
    data = list(reversed(p_result)) # Âõ†‰∏∫Êï∞ÊçÆÈáèÂ§™Â§ßÁöÑÊó∂ÂÄôÂÜÖÂ≠òÊ∂àËÄó‰∏•Èáç,ÂèàÂõ†‰∏∫ËøîÂõûÁöÑÊï∞ÊçÆÊòØÊåâÈ°∫Â∫èÁöÑÔºåÊâÄ‰ª•ÊàëÂèñÂèç,ÈááÁî®pop(),popÊó∂Èó¥Â§çÊùÇÂ∫¶ÊúÄ‰Ωé,ËÄå‰∏îÔºåÂèØ‰ª•ÂáèÂ∞ëÂÜÖÂ≠ò
    p_result = None
    count = 1
    while True:
        print(count)
        try:
            t_result_list = data.pop()
            for t_result in t_result_list.get():
                for i in  t_result:
                    ws.append(i)
            count += 1
        except IndexError:
            break

    # for t_result_list in p_result:
    #     for t_result in t_result_list.get():
    #         for i in t_result:
    #             ws.append(i)
    wb.save(r'D:\Ëá™Âä®ÂåñËÑöÊú¨-newpull3\thing\demodata\demo_{num}.xlsx'.format(num=1000))
    total_time = time.time() - start_time
    print(ws.max_row)
    print(total_time)
```

