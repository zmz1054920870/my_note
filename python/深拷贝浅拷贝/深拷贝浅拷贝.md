

# 一、浅拷贝和深拷贝

**首先深拷贝和浅拷贝都是对象的拷贝，都会生成一个看起来相同的对象，他们本质的区别是拷贝出来的对象的地址是否和原对象一样，也就是地址的复制还是值的复制的区别。**

首先我们要知道一个概念，那就是**什么是可变对象，什么是不可变对象：**

可变对象是指，一个对象在不改变其所指向的地址的前提下，可以修改其所指向的地址中的值；

不可变对象是指，一个对象所指向的地址上值是不能修改的，如果你修改了这个对象的值，那么它指向的地址就改变了，相当于你把这个对象指向的值复制出来一份，然后做了修改后存到另一个地址上了，但是可变对象就不会做这样的动作，而是直接在对象所指的地址上把值给改变了，而这个对象依然指向这个地址。



列表，字典就是一个可变对象，他们里面的值发送改变，但是列表对象的id是不会变的.

🔺其实我们现在学到的大部分数据结构都是可变对象。我们定义的类也是可变对象

```python
a = {"a":1, "b":2}
b = a.copy()

>>> id(a)
1765374957248

>>> id(b)
1765374956168

>>> b['b']=3

>>> id(a)
1765374957248

>>> id(b)
1765374956168

=======完美分割线=========
a = [1, 2, 3]
b = a.copy()

>>> id(a)
1765375321480
>>> id(b)
1765375174024

>>> a[0] = 10
>>> id(a)
1765375321480
>>> id(b)
1765375174024

=======完美分割线:字典的浅拷贝=========
a = {"a":{"b":1}}
b = a.copy()
>>> id(a)
1765375324448
>>> id(b)
1765374956240
>>> a['a']['b'] = 2

>>> a
{'a': {'b': 2}}
>>> b
{'a': {'b': 2}}

```

**如果一个对象里面嵌套了一个可变对象。当我们修改这个可变对象里面的元素的值的时候，其他浅拷贝的对象也会跟着发送改变**

**补充说一下元组浅拷贝以后id不会变，相当于赋值操作**

```python
# 补充说明一下，元组就两个方法一个count统计元素的个数,一个index返回元素的索引
import copy
a = ([1, 2], 3, [4, 5])
b = copy.copy(a)

>>> id(a)
1765375380864
>>> id(b)
1765375380864
```





**深拷贝和浅拷贝需要注意的地方就是可变元素的拷贝：**

在浅拷贝时，拷贝出来的新对象的地址和原对象是不一样的，但是新对象里面的可变元素（如列表）的地址和原对象里的可变元素的地址是相同的，也就是说浅拷贝它拷贝的是浅层次的数据结构（不可变元素），对象里的可变元素作为深层次的数据结构并没有被拷贝到新地址里面去，而是和原对象里的可变元素指向同一个地址，所以在新对象或原对象里对这个可变元素做修改时，两个对象是同时改变的，但是深拷贝不会这样，这个是浅拷贝相对于深拷贝最根本的区别。



浅拷贝的时候，我们拷贝的对象和原对象的内存id是不一样的，但是如果原对象里面还有一个可变对象，比如列表，在浅拷贝的时候，这里面的可变对象id和原对象里面的id是一样的。这就造成了一个问题。当我们修改这里值的时候，原对象和浅拷贝对象都会发生改变。而深拷贝就不会有这样的问题



一般我们说的深拷贝和浅拷贝，就是针对一个列表里面的可变元素里面的值（列表）

常见的形式是这样的 [[1, 2, 3], 4, [5, 6, 7]] 这种格式的数据就要警惕深拷贝和浅拷贝影响了



**浅拷贝的例子**

```python
import copy
a = [[1, 2, 3], 44, [5, 6, 7]]
b = a[:]						# 浅拷贝
c = a[0:1]						# 浅拷贝
d = a.copy()					# 浅拷贝
e = copy.copy(a)				# 浅拷贝

>>> a[0][0] = 10				# 后面的b c d e都会跟着变

>>> b
[[10, 2, 3], 44, [5, 6, 7]]

>>> c
[[10, 2, 3], 44, [5, 6, 7]]

>>> d
[[10, 2, 3], 44, [5, 6, 7]]

>>> e
[[10, 2, 3]]


#  我们再做如下修改
>>> b[0][0] = 100

>>> a
[[100, 2, 3], 44, [5, 6, 7]]

>>> b
[[100, 2, 3], 44, [5, 6, 7]]

>>> c
[[100, 2, 3]]

>>> d
[[100, 2, 3], 44, [5, 6, 7]]

>>> e
[[100, 2, 3], 44, [5, 6, 7]]
```



**深拷贝**

```python
import copy
a = [[1, 2, 3], 44, [5, 6, 7]]
b = copy.deepcopy(a)

>>> a[0][0] = 100
>>> a
[[100, 2, 3], 44, [5, 6, 7]]
>>> b
[[1, 2, 3], 44, [5, 6, 7]]
```

