[ç¬¬ä¸€ç«  NFSåŸºæœ¬åº”ç”¨](https://www.cnblogs.com/f-ck-need-u/p/7305755.html)

https://zhuanlan.zhihu.com/p/31626338

https://www.cnblogs.com/sfqas/p/12181074.html

https://blog.csdn.net/csdn100861/article/details/51440563



https://www.cnblogs.com/biebiejiujiu/p/13131016.html  NFSå’ŒNASçš„å…³é—­

æ„å»ºNFSæ–‡ä»¶å…±äº«åè®®

**æœ¯è¯­**

```bash
ACL			# è®¿é—®æ§åˆ¶æƒé™
anonymous	# åŒ¿å
squash		# å‹ç¼©
NAS			# Network Attached Storage ç½‘ç»œé™„åŠ å­˜å‚¨
SAN			# Storage Area Network å­˜å‚¨åŒºåŸŸç½‘ç»œ
NIS			# è‹±æ–‡çš„å…¨ç§°æ˜¯network information serviceï¼Œä¹Ÿå«yellow pagesã€‚åœ¨Linuxä¸­ï¼ŒNISæ˜¯ä¸€ä¸ªåŸºäºRPCçš„client/serverç³»ç»Ÿï¼Œéœ€è¦ä½¿ç”¨ RPC æœåŠ¡ã€‚
SAN and NAS # ä¸€ä½“åŒæ´»ï¼šä¸€å¥—è®¾å¤‡ä¸€å¥—æ€»è£ä¸€ç§ç½‘ç»œ ï¼Œç®€ç§°3ä¸ª1
BGP			# è¾¹ç•Œç½‘å…³åè®®
DACL		# è‡ªç”±è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼šå¯¹å¯¹è±¡æŒæœ‰è€…æ§åˆ¶è®¿é—®å¯¹è±¡ï¼Œå¹¶æ ‡æ˜ç‰¹å®šçš„ç”¨æˆ·ï¼Œç‰¹å®šçš„ç»„æ˜¯å¦èƒ½æŒæœ‰å¯¹è±¡ã€‚**ç®€å•ä¸€å¥è¯å°±æ˜¯è¯´ï¼Œå®šä¹‰å“ªä¸ªç”¨æˆ·ï¼Œæˆ–å“ªä¸ªç”¨æˆ·æ‰€å±çš„ç»„è®¿é—®è¯¥å¯¹è±¡çš„æƒé™ã€‚**

SACL		# ç³»ç»Ÿè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼šç”¨æ¥è®°å½•æŸä¸ªå®‰å…¨å¯¹è±¡è¢«è®¿é—®çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸º**å½“ç”¨æˆ·å»è®¿é—®çš„æ—¶å€™å…·æœ‰å¯¹è¯¥å®‰å…¨å¯¹è±¡çš„æƒé™ï¼**ï¼Œæ¯”å¦‚è¯»ã€å†™ã€è¿è¡Œç­‰çš„å­˜å–æ§åˆ¶æƒé™ç»†èŠ‚çš„åˆ—è¡¨

ACL			# è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼šDACLå’ŒSACLæ„æˆäº†æ•´ä¸ªå­˜å‚¨æ§åˆ¶åˆ—è¡¨`Access Control List`

ACE			# è®¿é—®æ§åˆ¶é¡¹ï¼šACLä¸­çš„æ¯ä¸€é¡¹ï¼Œæˆ‘ä»¬å«åšACEï¼ˆAccess Control Entryï¼‰

Securable Object	# å®‰å…¨dï¼š æ˜¯æ‹¥æœ‰SD(å®‰å…¨æè¿°ç¬¦)çš„Windowsçš„å¯¹è±¡ï¼Œæ‰€æœ‰çš„è¢«å‘½åçš„Windowsçš„å¯¹è±¡éƒ½æ˜¯å®‰å…¨å¯¹è±¡ï¼Œä½†æ˜¯ä¸€äº›æ²¡æœ‰å‘½åçš„å¯¹è±¡æ˜¯å®‰å…¨å¯¹è±¡ï¼Œå¦‚ï¼šè¿›ç¨‹å’Œçº¿ç¨‹ï¼Œä¹Ÿæœ‰å®‰å…¨æè¿°ç¬¦SDã€‚
```



## 1.1 æ¦‚è¿°

ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿã€‚é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è·¨ç½‘ç»œçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå°†è¿œç¨‹ä¸»æœºä¸Šçš„æ–‡ä»¶ç³»ç»Ÿ(æˆ–ç›®å½•)å­˜æ”¾åœ¨æœ¬åœ°ä¸»æœºä¸Šï¼Œå°±åƒå®ƒæœ¬èº«å°±æ˜¯æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸€æ ·ã€‚åœ¨Windowsç¯å¢ƒä¸‹æœ‰`cifs`åè®®å®ç°çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨Unixç¯å¢ƒä¸‹ï¼Œæœ€å‡ºåæ˜¯ç”±NFSåè®®å®ç°çš„NFSæ–‡ä»¶ç³»ç»Ÿã€‚



## 1.2 RPCä¸å¯ä¸çŸ¥çš„åŸç†

è¦ä»‹ç»NFSï¼Œå¿…ç„¶è¦å…ˆä»‹ç»RPCã€‚RPCæ˜¯remote procedure callçš„ç®€å†™ï¼Œäººä»¬éƒ½å°†å…¶è¯‘ä¸º"è¿œç¨‹è¿‡ç¨‹è°ƒç”¨"ï¼Œå®ƒæ˜¯ä¸€ç§æ¡†æ¶ï¼Œè¿™ç§æ¡†æ¶åœ¨å¤§å‹å…¬å¸åº”ç”¨éå¸¸å¤šã€‚è€ŒNFSæ­£æ˜¯å…¶ä¸­ä¸€ç§ï¼Œæ­¤å¤–NISã€hadoopä¹Ÿæ˜¯ä½¿ç”¨rpcæ¡†æ¶å®ç°çš„ã€‚



#### 1.2.1 RPC åŸç†

æ‰€è°“çš„remote procedure callï¼Œå°±æ˜¯åœ¨æœ¬åœ°è°ƒç”¨è¿œç¨‹ä¸»æœºä¸Šçš„procedureã€‚ä»¥æœ¬åœ°æ‰§è¡Œ"cat -n ~/abc.txt"å‘½ä»¤ä¸ºä¾‹ï¼Œåœ¨æœ¬åœ°æ‰§è¡Œcatå‘½ä»¤æ—¶ï¼Œä¼šå‘èµ·æŸäº›ç³»ç»Ÿè°ƒç”¨(å¦‚open()ã€read()ã€close()ç­‰)ï¼Œå¹¶å°†catçš„é€‰é¡¹å’Œå‚æ•°ä¼ é€’ç»™è¿™äº›å‡½æ•°ï¼Œäºæ˜¯æœ€ç»ˆå®ç°äº†æ–‡ä»¶çš„æŸ¥çœ‹åŠŸèƒ½ã€‚åœ¨RPCå±‚é¢ä¸Šç†è§£ï¼Œä¸Šé¢å‘èµ·çš„ç³»ç»Ÿè°ƒç”¨å°±æ˜¯procedureï¼Œæ¯ä¸ªprocedureå¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªåŠŸèƒ½ã€‚è€Œrpcçš„å…¨åremote procedure callæ‰€è¡¨ç¤ºçš„å°±æ˜¯å®ç°è¿œç¨‹procedureè°ƒç”¨ï¼Œè®©è¿œç¨‹ä¸»æœºå»è°ƒç”¨å¯¹åº”çš„procedureã€‚

ä¸Šé¢çš„catå‘½ä»¤åªæ˜¯æœ¬åœ°æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¦‚ä½•å®ç°è¿œç¨‹catï¼Œç”šè‡³å…¶ä»–è¿œç¨‹å‘½ä»¤ï¼Ÿé€šå¸¸æœ‰ä¸¤ç§å¯èƒ½å®ç°çš„æ–¹å¼ï¼š

(1).ä½¿ç”¨sshç±»çš„å·¥å…·ï¼Œå°†è¦æ‰§è¡Œçš„å‘½ä»¤ä¼ é€’åˆ°è¿œç¨‹ä¸»æœºä¸Šå¹¶æ‰§è¡Œã€‚ä½†sshæ— æ³•ç›´æ¥è°ƒç”¨è¿œç¨‹ä¸»æœºä¸Šcatæ‰€å‘èµ·çš„é‚£äº›ç³»ç»Ÿè°ƒç”¨(å¦‚open()ã€read()ã€close()ç­‰)ã€‚

(2).ä½¿ç”¨ç½‘ç»œsocketçš„æ–¹å¼ï¼Œå‘Šè¯‰è¿œç¨‹æœåŠ¡è¿›ç¨‹è¦è°ƒç”¨çš„å‡½æ•°ã€‚ä½†è¿™æ ·çš„ä¸»æœºé—´è¿›ç¨‹é€šä¿¡æ–¹å¼ä¸€èˆ¬éƒ½æ˜¯daemonç±»æœåŠ¡ï¼Œdaemonç±»çš„å®¢æˆ·ç«¯(å³æœåŠ¡çš„æ¶ˆè´¹æ–¹)æ¯è°ƒç”¨ä¸€ä¸ªæœåŠ¡çš„åŠŸèƒ½ï¼Œéƒ½éœ€è¦ç¼–å†™ä¸€å †å®ç°ç½‘ç»œé€šä¿¡ç›¸å…³çš„ä»£ç ã€‚ä¸ä»…å®¹æ˜“å‡ºé”™ï¼Œè¿˜æ¯”è¾ƒå¤æ‚ã€‚

è€Œrpcæ˜¯æœ€å¥½çš„è§£å†³æ–¹å¼ã€‚rpcæ˜¯ä¸€ç§æ¡†æ¶ï¼Œåœ¨æ­¤æ¡†æ¶ä¸­å·²ç»é›†æˆäº†ç½‘ç»œé€šä¿¡ä»£ç å’Œå°åŒ…ã€è§£åŒ…æ–¹å¼(ç¼–ç ã€è§£ç )ã€‚ä»¥ä¸‹æ˜¯rpcæ•´ä¸ªè¿‡ç¨‹ï¼Œä»¥cat NFSæ–‡ä»¶ç³»ç»Ÿä¸­çš„a.shæ–‡ä»¶ä¸ºä¾‹ã€‚



NFS client  è§£æå‘½åï¼Œæå–procedure id å’Œ å‚æ•°--> RPC client ï¼ŒRPC Client å°è£… procedure id ï¼Œprogram idï¼Œå‚æ•°  ,é€šè¿‡socket ------> RPC Server , RPC Server è§£åŒ… ---- > ç»™ NFS server è¿›è¡Œæ‰§è¡Œï¼Œç„¶åè¿”å›ç›´æ¥ç»“æœç»™ RPC Server ï¼Œç„¶ååŸè·¯è¿”å›



#### 1.2.2 RPC å·¥å…·ä»‹ç»

åœ¨centos6/7 ä¸Šï¼Œ rpc server ç”± rpcbind ç¨‹åºå®ç°ï¼Œ rpcbindåŒ…é‡Œé¢æœ‰ rpcbind

```bash
[root@xuexi ~]# yum -y install rpcbind

[root@xuexi ~]# rpm -ql rpcbind | grep bin/
/usr/sbin/rpcbind
/usr/sbin/rpcinfo
```

å…¶ä¸­rpcbindæ˜¯rpcä¸»ç¨‹åºï¼Œåœ¨rpcæœåŠ¡ç«¯è¯¥ç¨‹åºå¿…é¡»å¤„äºå·²è¿è¡ŒçŠ¶æ€ï¼Œå…¶**é»˜è®¤ç›‘å¬åœ¨111ç«¯å£**ã€‚rpcinfoæ˜¯rpcç›¸å…³ä¿¡æ¯æŸ¥è¯¢å·¥å…·

å¯¹äºrpcè€Œè¨€ï¼Œå…¶æ‰€ç›´æ¥ç®¡ç†çš„æ˜¯programsï¼Œprogramsç”±ä¸€ä¸ªæˆ–å¤šä¸ªprocedureç»„æˆã€‚è¿™äº›programç§°ä¸ºRPC programæˆ–RPC serviceã€‚

å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­NFSã€NISã€hadoopç­‰ç§°ä¸ºç½‘ç»œæœåŠ¡ï¼Œå®ƒä»¬ç”±å¤šä¸ªè¿›ç¨‹æˆ–ç¨‹åº(program)ç»„æˆã€‚ä¾‹å¦‚NFSåŒ…æ‹¬rpc.nfsdã€rpc.mountdã€rpc.statdå’Œrpc.idmapdç­‰programsï¼Œå…¶ä¸­æ¯ä¸ªprograméƒ½åŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªprocedureï¼Œä¾‹å¦‚rpc.nfsdè¿™ä¸ªç¨‹åºåŒ…å«äº†å¦‚OPENã€CLOSEã€READã€COMPOUNDã€GETATTRç­‰procedureï¼Œrpc.mountdä¹Ÿä¸»è¦æœ‰MNTå’ŒUMNTä¸¤ä¸ªprocedureã€‚

![image-20211106215755781](image-20211106215755781.png)



å¯¹äºRPCè€Œè¨€ï¼Œå®ƒæ˜¯ä¸çŸ¥é“NFS/NIS/hadoopè¿™ä¸€å±‚çš„ï¼Œå®ƒç›´æ¥ç®¡ç†programsã€‚æ¯ä¸ªprogramå¯åŠ¨æ—¶éƒ½éœ€è¦æ‰¾111ç«¯å£çš„rpcæœåŠ¡ç™»è®°æ³¨å†Œï¼Œç„¶åRPCæœåŠ¡ä¼šä¸ºè¯¥programæ˜ å°„ä¸€ä¸ªprogram numberä»¥åŠåˆ†é…ä¸€ä¸ªç«¯å£å·ã€‚å…¶ä¸­æ¯ä¸ªprograméƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ä¸ä¹‹å¯¹åº”çš„program numberï¼Œå®ƒä»¬çš„æ˜ å°„å…³ç³»å®šä¹‰åœ¨/etc/rpcæ–‡ä»¶ä¸­ã€‚ä»¥årpc serverå°†ä½¿ç”¨program numberæ¥åˆ¤æ–­è¦è°ƒç”¨çš„æ˜¯å“ªä¸ªprogramä¸­çš„å“ªä¸ªprocedure(å› ä¸ºè¿™äº›éƒ½æ˜¯rpc clientå°è£…åœ¨"call message"ä¸­çš„)ï¼Œå¹¶å°†è§£åŒ…åçš„æ•°æ®ä¼ é€’ç»™è¯¥programå’Œprocedureã€‚

ä¾‹å¦‚åªå¯åŠ¨rpcbindæ—¶ã€‚



```bash
root@xuexi ~]# systemctl start rpcbind.service

[root@xuexi ~]# rpcinfo -p localhost
   program vers proto   port  service
    100000    4   tcp    111  portmapper
    100000    3   tcp    111  portmapper
    100000    2   tcp    111  portmapper
    100000    4   udp    111  portmapper
    100000    3   udp    111  portmapper
    100000    2   udp    111  portmapper
```

å…¶ä¸­ç¬¬ä¸€åˆ—å°±æ˜¯program numberï¼Œç¬¬äºŒåˆ—versè¡¨ç¤ºå¯¹åº”programçš„ç‰ˆæœ¬å·ï¼Œæœ€åä¸€åˆ—ä¸ºRPCç®¡ç†çš„RPC serviceåï¼Œå…¶å®å°±æ˜¯å„programå¯¹åº”çš„ç§°å‘¼ã€‚

```bash
[root@xuexi ~]# systemctl start nfs.service

[root@xuexi ~]# rpcinfo -p localhost
   program vers proto   port  service
    100000    4   tcp    111  portmapper
    100000    3   tcp    111  portmapper
    100000    2   tcp    111  portmapper
    100000    4   udp    111  portmapper
    100000    3   udp    111  portmapper
    100000    2   udp    111  portmapper
    100024    1   udp  56229  status
    100024    1   tcp  57226  status
    100005    1   udp  20048  mountd
    100005    1   tcp  20048  mountd
    100005    2   udp  20048  mountd
    100005    2   tcp  20048  mountd
    100005    3   udp  20048  mountd
    100005    3   tcp  20048  mountd
    100003    3   tcp   2049  nfs
    100003    4   tcp   2049  nfs
    100227    3   tcp   2049  nfs_acl
    100003    3   udp   2049  nfs
    100003    4   udp   2049  nfs
    100227    3   udp   2049  nfs_acl
    100021    1   udp  48609  nlockmgr
    100021    3   udp  48609  nlockmgr
    100021    4   udp  48609  nlockmgr
    100021    1   tcp  50915  nlockmgr
    100021    3   tcp  50915  nlockmgr
    100021    4   tcp  50915  nlockmgr
```

```bash
nfs	 	----  	å¯¹åº”rpc.nfsd ä¸ºnfsæœåŠ¡çš„ä¸»è¿›ç¨‹ï¼Œç«¯å£å·ä¸º2049
mountd	----	å¯¹åº”rpc.mountdç¨‹åºã€‚å®ƒä¸ºå®¢æˆ·ç«¯çš„mountå’Œumountå‘½ä»¤æä¾›æœåŠ¡
nlockmgr ----	å¯¹åº”rpc.statdç¨‹åºã€‚ç”¨äºç»´æŠ¤æ–‡ä»¶é”å’Œæ–‡ä»¶å§”æ‰˜ç›¸å…³åŠŸèƒ½
nfs_aclå’Œstatus	è®¿é—®æ§åˆ¶åˆ—è¡¨å’ŒçŠ¶æ€ä¿¡æ¯ç»´æŠ¤çš„programã€‚
```

å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªprograméƒ½å¯åŠ¨äº†ä¸åŒç‰ˆæœ¬çš„åŠŸèƒ½ã€‚å…¶ä¸­nfs programä¸ºrpc.nfsdå¯¹åº”çš„programï¼Œä¸ºnfsæœåŠ¡çš„ä¸»è¿›ç¨‹ï¼Œç«¯å£å·ä¸º2049ã€‚mountdå¯¹åº”çš„programä¸ºrpc.mountdï¼Œå®ƒä¸ºå®¢æˆ·ç«¯çš„mountå’Œumountå‘½ä»¤æä¾›æœåŠ¡ï¼Œå³æŒ‚è½½å’Œå¸è½½NFSæ–‡ä»¶ç³»ç»Ÿæ—¶ä¼šè”ç³»mountdæœåŠ¡ï¼Œç”±mountdç»´æŠ¤ç›¸å…³æŒ‚è½½ä¿¡æ¯ã€‚nlockmgrå¯¹åº”çš„programä¸ºrpc.statdï¼Œç”¨äºç»´æŠ¤æ–‡ä»¶é”å’Œæ–‡ä»¶å§”æ‰˜ç›¸å…³åŠŸèƒ½ï¼Œåœ¨NFSv4ä»¥å‰ï¼Œç§°ä¹‹ä¸ºNSM(network status manager)ã€‚nfs_aclå’Œstatusï¼Œå¾ˆæ˜¾ç„¶ï¼Œå®ƒä»¬æ˜¯è®¿é—®æ§åˆ¶åˆ—è¡¨å’ŒçŠ¶æ€ä¿¡æ¯ç»´æŠ¤çš„programã€‚

å†çœ‹çœ‹å¯åŠ¨çš„ç›¸å…³è¿›ç¨‹ä¿¡æ¯ã€‚

```bash
[root@xuexi ~]# ps aux | grep -E "[n]fs|[r]pc"
root        748  0.0  0.0      0     0 ?        S<   Jul26   0:00 [rpciod]
rpc        6127  0.0  0.0  64908  1448 ?        Ss   Jul26   0:00 /sbin/rpcbind -w
rpcuser    6128  0.0  0.0  46608  1836 ?        Ss   Jul26   0:00 /usr/sbin/rpc.statd --no-notify
root       6242  0.0  0.0      0     0 ?        S<   Jul26   0:00 [nfsiod]
root       6248  0.0  0.0      0     0 ?        S    Jul26   0:00 [nfsv4.0-svc]
root      17128  0.0  0.0  44860   976 ?        Ss   02:49   0:00 /usr/sbin/rpc.mountd
root      17129  0.0  0.0  21372   420 ?        Ss   02:49   0:00 /usr/sbin/rpc.idmapd
root      17134  0.0  0.0      0     0 ?        S<   02:49   0:00 [nfsd4]
root      17135  0.0  0.0      0     0 ?        S<   02:49   0:00 [nfsd4_callbacks]
root      17141  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
root      17142  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
root      17143  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
root      17144  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
root      17145  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
root      17146  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
root      17147  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
root      17148  0.0  0.0      0     0 ?        S    02:49   0:00 [nfsd]
```

å…¶ä¸­æœ‰ä¸€é¡¹/usr/sbin/rpc.idmapdè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹æ˜¯æä¾›æœåŠ¡ç«¯çš„uid/gid <==> username/groupnameçš„æ˜ å°„ç¿»è¯‘æœåŠ¡ã€‚å®¢æˆ·ç«¯çš„uid/gid <==> username/groupnameçš„æ˜ å°„ç¿»è¯‘æœåŠ¡åˆ™ç”±"nfsidmap"å·¥å…·å®ç°ï¼Œè¯¦ç»†è¯´æ˜è§ä¸‹æ–‡ã€‚





## 1.4 é…ç½®åˆ°å¤„ç›®å½•å’ŒæŒ‚è½½ä½¿ç”¨

#### 1.4.1 é…ç½®nfsåˆ°å¤„ç›®å½•

åœ¨å°†æœåŠ¡ç«¯çš„ç›®å½•å…±äº«(share)æˆ–è€…è¯´å¯¼å‡º(export)ç»™å®¢æˆ·ç«¯ä¹‹å‰ï¼Œéœ€è¦å…ˆé…ç½®å¥½è¦å¯¼å‡ºçš„ç›®å½•ã€‚æ¯”å¦‚ä½•äººå¯è®¿é—®è¯¥ç›®å½•ï¼Œè¯¥ç›®å½•æ˜¯å¦å¯å†™ï¼Œä»¥ä½•äººèº«ä»½è®¿é—®å¯¼å‡ºç›®å½•ç­‰ã€‚























ğŸ”ºğŸ”ºprogram å’Œ program numberçš„æ˜ å°„è·¯å¾„åœ¨ /etc/rpc æ–‡ä»¶é‡Œé¢

```bash
# æŸ¥çœ‹æœ¬åœ°çš„æ˜ å°„å…³ç³»(procedure number å’Œ )
rpcinfo -p localhost

# å¯åŠ¨rpcbindæœåŠ¡
systemctl start rpcbind.service

# å¯åŠ¨nfs æœåŠ¡
systemctl start nfs.service

# æŸ¥çœ‹centosçš„ç‰ˆæœ¬å·
cat /etc/redhat-release
CentOS Linux release 7.6.1810 (Core)


# NFSçš„å¸¸ç”¨ç›®å½•
/etc/exports                   NFSæœåŠ¡çš„ä¸»è¦é…ç½®æ–‡ä»¶

/usr/sbin/exportfs             NFSæœåŠ¡çš„ç®¡ç†å‘½ä»¤

/usr/sbin/showmount             å®¢æˆ·ç«¯çš„æŸ¥çœ‹å‘½ä»¤

/var/lib/nfs/etab             è®°å½•NFSåˆ†äº«å‡ºæ¥çš„ç›®å½•çš„å®Œæ•´æƒé™è®¾å®šå€¼

/var/lib/nfs/xtab             è®°å½•æ›¾ç»ç™»å½•è¿‡çš„å®¢æˆ·ç«¯ä¿¡æ¯

# å¯¹äºnfsæœåŠ¡å™¨æ¥è¯´ï¼ŒæŸ¥çœ‹æœ‰å“ªäº›å®¢æˆ·ç«¯è¿è¿‡æ¥
showmount -a
All mount points on hecs-263993-0001:

# åœ¨nfså®¢æˆ·ç«¯ä¸Šï¼ŒæŸ¥çœ‹è¿œç¨‹æœ‰å“ªäº›æŒ‚è½½ç‚¹(å®¢æˆ·ç«¯ipä¸º192.168.0.172)
showmount -e 192.168.0.83
Export list for 192.168.0.83:
/data/nfs-share *


```



ã€

```
[root@hecs-263993-0001 ~]# tcpdump src 192.168.172
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
^C
0 packets captured
0 packets received by filter
0 packets dropped by kernel
[root@hecs-263993-0001 ~]# tcpdump dst 192.168.0.172
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
17:22:37.099166 IP hecs-263993-0001 > 192.168.0.172: ICMP echo reply, id 31866, seq 1, length 64
17:22:38.099392 IP hecs-263993-0001 > 192.168.0.172: ICMP echo reply, id 31866, seq 2, length 64
17:22:39.099395 IP hecs-263993-0001 > 192.168.0.172: ICMP echo reply, id 31866, seq 3, length 64
17:22:40.099335 IP hecs-263993-0001 > 192.168.0.172: ICMP echo reply, id 31866, seq 4, length 64
17:22:41.099299 IP hecs-263993-0001 > 192.168.0.172: ICMP echo reply, id 31866, seq 5, length 64
17:22:42.099292 IP hecs-263993-0001 > 192.168.0.172: ICMP echo reply, id 31866, seq 6, length 64

```



```
[root@hecs-263993-0001 ~]# tcpdump src 192.168.0.172
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
17:22:52.301007 IP 192.168.0.172 > hecs-263993-0001: ICMP echo request, id 31879, seq 1, length 64
17:22:53.301339 IP 192.168.0.172 > hecs-263993-0001: ICMP echo request, id 31879, seq 2, length 64
17:22:54.301383 IP 192.168.0.172 > hecs-263993-0001: ICMP echo request, id 31879, seq 3, length 64
17:22:57.310639 ARP, Request who-has hecs-263993-0001 tell 192.168.0.172, length 28
17:23:23.854255 IP 192.168.0.172.xact-backup > hecs-263993-0001.nfs: Flags [.], ack 3044022472, win 999, options [nop,nop,TS val 2945330176 ecr 2945272023], length 0
17:23:23.854292 IP 192.168.0.172.xact-backup > hecs-263993-0001.nfs: Flags [P.], seq 1:129, ack 1, win 999, options [nop,nop,TS val 2945330176 ecr 2945272023], length 128: NFS request xid 37807196 124 getattr fh 0,1/53
17:23:23.854494 IP 192.168.0.172.xact-backup > hecs-263993-0001.nfs: Flags [.], ack 85, win 999, options [nop,nop,TS val 2945330176 ecr 2945332183], length 0
17:23:28.855874 ARP, Reply 192.168.0.172 is-at fa:16:3e:02:c4:4a (oui Unknown), length 28
17:24:24.014256 IP 192.168.0.172.xact-backup > hecs-263993-0001.nfs: Flags [.], ack 85, win 999, options [nop,nop,TS val 2945390336 ecr 2945332183], length 0
17:24:24.014270 IP 192.168.0.172.xact-backup > hecs-263993-0001.nfs: Flags [P.], seq 129:257, ack 85, win 999, options [nop,nop,TS val 2945390336 ecr 2945332183], length 128: NFS request xid 54584412 124 getattr fh 0,1/53
17:24:24.014451 IP 192.168.0.172.xact-backup > hecs-263993-0001.nfs: Flags [.], ack 169, win 999, options [nop,nop,TS val 2945390336 ecr 2945392343], length 0
17:24:29.015946 ARP, Reply 192.168.0.172 is-at fa:16:3e:02:c4:4a (oui Unknown), length 28

```









**é—®é¢˜æ”¶é›†**

```bash
nfs4 æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼Œå±äºä¸»ä¸ºnobodyï¼Œ ä¸ä¸ºroot
```









https://www.cnblogs.com/sfqas/p/12181074.html

https://blog.csdn.net/csdn100861/article/details/51440563

https://www.cnblogs.com/merely/p/10793877.html

https://langyastudio.blog.csdn.net/article/details/78518936?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link



https://langyastudio.blog.csdn.net/article/details/78518936?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link



https://www.cnblogs.com/f-ck-need-u/p/7305755.html



http://www.szliwen.com/802.html

https://www.cnblogs.com/sunjj/p/12273869.html



https://www.cnblogs.com/merely/p/10793877.html

https://zhuanlan.zhihu.com/p/31626338

https://blog.csdn.net/cusi77914/article/details/107113548