## 一、韧性测试相关术语

**资产相关的定义**

- 关键资产

	主要是说通过恶意攻击或破坏某类资产，攻击者得到最大利益，对被攻击者造成重大损失，带来严重的经济和社会影响；或者资产一旦出现故障，业务影响和损失很大。

- 价值资产

	系统相关的且能够为攻击者带来价值的资产，一般是系统对外提供的服务或者业务，从攻击者的视角看，价值资产是攻击者的攻击目标



**架构元素&Mission**

- 架构元素：按照价值资产定义，架构元素大部分情况下属于价值资产的范畴
- Mission：系统存在的目的是在其环境中完成一个或多个mission，mission是系统的设计意图所达到的能目标



**TMBT威胁建模测试设计方法**

- TMC： Threat Mitigation Checkpoint（威胁缓解检查点）对安全韧性风险的消除措施进行分析，检验消除措施在实施过程中是否遵照所要求的去正确实现

- TMA：Threat Mitigation Attack （威胁缓解攻击）从攻击者角度对消减措施进行分析，检验消除措施是否真正的有效。对于韧性，在攻击的同时要检查Mission及SLA状态，系统监控状态，评估消减措施的有效性。

TMC是检查设计是否有效，TMA是真实攻击，检查是否有效



华为韧性定义：  在系统受攻击时保证关键mission达成的能力。mission达成情况（服务水平SLA）是韧性测试的重要观察点。是评估韧性能力的重要标准

- SLA： 描述了客户可以接受的服务水平，SLA把承诺的服务质量进行量化，



## 二、业界韧性测试标准

**NIST**美国的标准

主要聚焦高级持续性威胁的影响

**ENISA**欧洲标准

定义：韧性是网络在面对各种故障和正常运作挑战时，提供和维持可接受的服务水平的能力

跳转包括：配置或误操作，大范围灾害、恶意攻击，硬件失效，或者服务提供商故障、浪涌

总结：NIST和ENISA，威胁来源除了恶意攻击外还包括环境，压力，人因差错等，但是NIST更强调韧性聚焦APT攻击

APT（Advanced Persistent Threat）高级持续威胁

**华为标准**

系统受攻击时承受并保持在有定义的运行状态（包括降级）、恢复并适应攻击以保障Mission达成的能力

Mission：系统存在的目的是在其环境中完成一个或多个mission，mission是使用系统的设计意图所达成的目标。而系统的设计意图是一个或者多个利益相关者所期望的

**华为定义的理解：**

- 受攻击时：说明韧性的视角是攻防视角
- 有定义的运行状态：系统状态可预期，包括降级运行状态；
- 恢复适应：说明韧性积极考虑系统受损的场景，并非仅仅防御
- 保障misson：说明韧性的目标是保障系统利益相关人价值相关的mission达成





侦察、武器化、下发、bug利用、控制、执行、维护



## 三、NIST SP 800 160 vol2 / MITRE 等提出的网络韧性威胁模型



在网络攻击的控制阶段，攻击者可以篡改系统组件（例如：修改软件，用恶意软件替换合法软件）、系统数据（例如：修改配置文件、在授权数据库中制作条目，伪造和删除审计数据）、mission数据（例如：删除、变更或插入mission数据库中的条目，用编译版本替换用户创建的文件）



韧性威胁模型使用CAL/CKC模型，同网络攻击生命周期模型



MITRE ATT&CK  ，是一套反应各个攻击生命周期攻击行为的模型和知识库，对于后五个阶段进行喜欢





## 四、韧性测试定义和IBO模型

韧性测试定义：韧性测试是对系统关键资产或架构元素进行恶意破坏，观察系统能否检测、承受并保持有定义的运行状态（包括降级）、能否快速恢复以保障Mission的达成的一种测试活动



#### IBO模型

**威胁：**

- 传统的安全攻击威胁
	- 如DDOS、Fuzz和渗透测试
- 高级持续威胁（APT）
	- 与安全差异：它是能够绕过防御、检查、权限机制，长期潜伏
	- 攻击位置：系统组件、系统数据、Mission数据等
	- 威胁模型：网络攻击生命周期CAL/CKC，ATT&CK模型和知识库
	- 威胁特点：
		- 潜伏期恶意修改系统
			- 修改系统软件、增删改系统数据和Mission数据
		- 伪装灾害
		- 利用灾害
			- 包括认为错误、结构失效或自然灾害



威胁作为输入

预期结果：

- 能力模型
	- 防御、检查、响应、恢复

测试结论：

- 防御：
- 检查：检查时长，检测成功率
- 响应：业务中断时长，业务损失率
- 恢复：恢复时长，业务恢复率 





## ATT &CK攻击技术分析

**ATT & CK 12种攻击技术类别**

初始访问

执行

持久化

特权提升

防御绕过

凭据访问

披露

横向移动

收集

数据渗透

命令与控制

影响



前九种：同网络攻击生命周期---- 传送、漏洞利用、操控。 系统未产生影响，系统已产生破坏

后面三种：同网络攻击生命周期 ---- 执行与维护

安全和韧性威胁都采用安全生命周期攻击模型，ATT&CK是实践之一，安全韧性威胁来源一致



ATT&CK 后三种技术聚焦对系统产生破坏行为，是韧性测试需要重点关注的攻击技术，韧性测试重点关注Mission/SLA的测量



ATT&CK前九种技术聚焦对系统进行渗透，不主观产生破坏，但如果系统脆弱也会产生破坏，在安全测试时候也需要关注韧性属性，对于APT攻击场景系统可能无法监测到渗透进入过程





## 韧性测试框架

测试设计采用IBO模型

测试设计方法： 正向IMC、负向IMDR。 参考 韧性测试模型库（入侵破坏样本：入侵模式+仿真方法+关键Mission状态）

测试执行方法：测试执行方法参考  ，韧性测试执行框架，注入的方法/监控的方法

测试评估标准：防御、检测、响应入侵或故障的能力及恢复







# 二、产品韧性设计要素与测试参考



韧性的高级目标Goal和目标Objective

**韧性高级目标Goal**

- 预期 Anticipate
	- 是指对不利情况，系统已准备的应对措施处理
- 承受 Withstand
	- 是指系统在被恶意入侵后还具备完成关键业务功能的能力，同时在一定程度上为系统的恢复和适应争取了缓冲时间
- 恢复 Recover
	- 是指系统在受到攻击的影响超出预期阶段的可承受范围之后可能出现关键任务和业务功能受损，这时应有一些预设的方案和技术确保在一定的时间窗内关键任务或业务功能恢复到正常进行
- 适应 Adapt
	- 是指根据技术、操作或威胁环境中的预测变化修改任务、业务功能或支撑能力



攻击意图：价值资产、暴露面、攻击路径、风险模型、安全/韧性技术措施

价值资产

| 资产类型 | 价值资产     |
| -------- | ------------ |
| 账户信息 | 用户账户信息 |
|          | 管理账户信息 |
| 用户数据 | 个人数据     |
|          | 用户通信数据 |
| 服务     | 业务服务     |
|          | 安全服务     |
| 控制权   | 系统控制权   |
| 硬件     | 物理设备     |

暴露面

| 暴露面类型 | 子类     |
| ---------- | -------- |
| 物理接口   | 有线接口 |
|            | 无线接口 |
| 逻辑接口   | 数据接口 |
|            | 管理接口 |
|            | 控制接口 |
| 协议栈     | 。。。   |





# 三、韧性测试设计方法

**测试设计方法**

- TMC
- TMA

韧性验证要对韧性设计和韧性能力进行验证

韧性设计验证的依据

- XX威胁模式&韧性设计需求
- 系统韧性架构
- 韧性技术方案&特性设计说明书



系统级韧性能力验证

根据如下生成测试模式库

- 业界攻击模式知识库（ATT&CK/CAPEC等）
- 安全韧性标准、法规
- 网上问题
- 。。。。



输出

- 消减措施正确实现（TMC）

	- 安全边界防护
	- 数据完整性校验
	- 冗余倒置
	- 启动最小系统
	- 措施实施的一致性、完整性检查

- 消除措施有效实现（TMA）

	主要关注Mission和SLA

	- 降低攻击可能（防御）
	- 降低影响范围（检测预期）
	- 保障核心业务（响应）
	- 快速恢复业务（恢复）

**韧性执行思路**

实施攻击

攻击方法可参考

- ATT&CK
- 传统攻击模式（如DDOS和Fuzz渗透）
- 公司威胁模式库
- 。。。

观测项

- Mission状态
- KPI
- SLA

观测攻击

- 态势感知系统
- 仿真监控平台



## 四、业界攻击模式知识库

分为高中低三层

其中Cyber kill Chain 和STRIDE为高

MITRE ATT&CK为中

CAPEC、CWE为低

CAPEC关注的是攻击者对网络空间脆弱性的利用，其核心概念攻击模式ATTACK Pattern



韧性测试模式库与安全、可靠性测试模式的区别

- 韧性关注存在绕过防御、检测可能的测试模式
- 韧性关注APT攻击方式的测试模式





